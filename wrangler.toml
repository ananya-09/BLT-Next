# Cloudflare Workers Configuration for BLT-Next

name = "blt-api"
main = "workers/main.py"
compatibility_date = "2024-04-03"
compatibility_flags = [ "python_workers" ]

[assets]
directory = "src"
binding = "ASSETS"

# Python support
[build]
command = ""

# Environment variables (set these in Cloudflare dashboard)
# [vars]
# ENVIRONMENT = "production"

# Secrets (set via wrangler secret put)
# - JWT_SECRET
# - DATABASE_URL
# - ENCRYPTION_KEY

# KV Namespaces for caching
# [[kv_namespaces]]
# binding = "CACHE"
# id = "your-kv-namespace-id"

[[d1_databases]]
binding = "DB"
database_name = "blt-database"
database_id = "00000000-0000-0000-0000-000000000000" # Placeholder ID

# Rate limiting
[[routes]]
pattern = "*/api/*"
zone_name = "your-domain.com"

# Development
[env.development]
name = "blt-api-dev"

# Production
[env.production]
name = "blt-api-prod"
route = "https://api.owaspblt.org/*"

# Triggers
[triggers]
crons = []

# Observability
[observability]
enabled = true
head_sampling_rate = 1
